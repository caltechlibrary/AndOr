<!DOCTYPE html>
<html>
<head>
    <title>Caltech Library's Digital Library Development Sandbox</title><link rel="stylesheet" href="/css/site.css">
</head>
<body>
<header><a href="https://library.caltech.edu"><img src="/assets/liblogo.gif" alt="Caltech Library logo"></a>
</header>
<nav>
<ul>
<li><a href="/">Home</a></li>
<li><a href="../">README</a></li>
<li><a href="../license.html">LICENSE</a></li>
<li><a href="../install.html">INSTALL</a></li>
<li><a href="./">Documentation</a></li>
<li><a href="https://github.com/caltechlibrary/AndOr">GitHub</a>
<!-- + [Releases](https://github.com/caltechlibrary/AndOr/releases/) --></li>
</ul>

</nav>

<section>
<blockquote class="red">DRAFT, Proof of Concept</blockquote>
<h1>Workflow Use Cases</h1>

<p>Below are use cases exploring how a user/workflow/queue model
would allow or prevent actions on objects in a collection.</p>

<h2>Use case 1</h2>

<p>We would like people (e.g. Jane) to curate the collection.
To curate the whole collection Jane needs to have the
following permissions&ndash; create, read, update, delete,
change workflow queues.  We can define a workflow to work
apply to all objects and and make Jane a member of that workflow.</p>

<pre><code class="language-json">    {
        &quot;workflow_name&quot;: &quot;Curators&quot;,
        &quot;workflow_id&quot;: &quot;curators&quot;,
        &quot;queue&quot;: &quot;*&quot;,
        &quot;create&quot;: true,
        &quot;read&quot; : true,
        &quot;update&quot; : true,
        &quot;delete&quot; : true,
        &quot;assign_to&quot;: [ &quot;*&quot; ],
    }
</code></pre>

<p>Notice that we use &ldquo;*&rdquo; twice. First we specify the
queue value as &ldquo;*&rdquo;. This special, it means this
workflow applies to ALL objects holding any <code>._Queue</code>
value. The second place of &ldquo;*&rdquo; is in the list of
<code>.assign_to</code>. Again this means a curator can assign objects
in this workflow to ANY workflow.</p>

<p>Jane needs to be a curator. We add &ldquo;curator&rdquo; to the
<code>.member_of</code> list in her user object.
Jane&rsquo;s email address is &ldquo;jane@example.edu&rdquo; and what
we&rsquo;ve used as a user id.</p>

<pre><code class="language-json">    {
        &quot;user_id&quot;: &quot;jane@example.edu&quot;,
        &quot;display_name&quot;: &quot;Jane&quot;,
        &quot;member_of&quot;: [ &quot;curators&quot; ]
    }
</code></pre>

<p>When Jane authenticates with the system she goes from being
&ldquo;anonymous&rdquo; to &ldquo;jane@example.edu&rdquo; user.  This means she now has the
permissions of a curator. The workflow &ldquo;curator&rdquo; gives Jane
all rights of creation, read, update, delete and assignment on
any object in the collection(s). This workflow is generally
too permissive outside private collections.</p>

<h2>Use case 2</h2>

<p>We would like the public to be able to view the &ldquo;published&rdquo; contents
of the of our collection. We can do this by creating a workflow queue
&ldquo;public&rdquo; and given read access in the &ldquo;published&rdquo; queue. We also
want to create a user object for &ldquo;anonymous&rdquo; (un-authenticated users)
and make &ldquo;anonymous&rdquo; a member of &ldquo;public&rdquo;.</p>

<p>The workflow queue object would look like</p>

<pre><code class="language-json">    {
        &quot;workflow_name&quot;: &quot;Public&quot;,
        &quot;workflow_id&quot;: &quot;public&quot;,
        &quot;queue&quot;: &quot;published&quot;,
        &quot;create&quot;: false,
        &quot;read&quot;: true,
        &quot;update&quot;: false,
        &quot;delete&quot;: false,
        &quot;assign_to&quot;: [ ]
    }
</code></pre>

<p>The &ldquo;anonymous&rdquo; user object would look like</p>

<pre><code class="language-json">    {
        &quot;user_id&quot;: &quot;anonymous&quot;,
        &quot;display_name&quot;: &quot;&quot;,
        &quot;member_of&quot;: [ &quot;public&quot; ]
    }
</code></pre>

<p>Combining this with use case 1, we would have a single user
named Jane who can publish objects by assigning objects to
&ldquo;public&rdquo;.</p>

<h2>Use case 3</h2>

<p>We want to allow anonymous users to &ldquo;deposit&rdquo; objects.  We can
create a workflow queue called &ldquo;deposit&rdquo;. It should only have create
permissions for the &ldquo;review&rdquo; queue.  If we give &ldquo;anonymous&rdquo;
&ldquo;deposit&rdquo; membership they can create objects that will be added
to the &ldquo;review&rdquo; queue. They will not be in the &ldquo;published&rdquo; queue
to until someone intervines they will be invisible to the public.
Remember since anonymous is a member of &ldquo;public&rdquo; they will be
able to still read all published records.</p>

<pre><code class="language-json">    {
        &quot;workflow_name&quot;: &quot;Depositor&quot;,
        &quot;workflow_id&quot;: &quot;deposit&quot;,
        &quot;queue&quot;: &quot;review&quot;,
        &quot;create&quot;: true,
        &quot;read&quot;: false,
        &quot;update&quot;: false, 
        &quot;delete&quot;: false,
        &quot;assign_to&quot;: [ ]
    }
</code></pre>

<p>Now if we update our &ldquo;anonymous&rdquo; user we can add them to
the &ldquo;deposit&rdquo; workflow queue and associate the created object with
a workflow queue called &ldquo;deposit&rdquo;.</p>

<pre><code class="language-json">    {
        &quot;userid&quot;: &quot;anonymous&quot;,
        &quot;display_name&quot;: &quot;Public&quot;,
        &quot;member_of&quot;: [ &quot;public&quot;, &quot;deposit&quot; ]
    }
</code></pre>

<p>Because the object created will have the workflow queue &ldquo;review&rdquo; and
our &ldquo;curators&rdquo; workflow queue has permissions to list all objects workflow
queues we can treat the &ldquo;deposit&rdquo; workflow queue as an inbox to be
processed.  If the curators approved the deposit they can change the
objects&rsquo; workflow queue to &ldquo;published&rdquo;.</p>

<h2>Use case 4</h2>

<p>Creating workflows with queues. We would like our objects to travel
between the following states - review, editorial, published, embargoed.
Everything starts in review, our reviewers can move the object onto
either editorial, published or embargoed states.</p>

<p>Here are some of our policies we want to enforce.</p>

<ol>
<li>Allow any authenticated user to deposit

<ul>
<li>remove the &ldquo;deposit&rdquo; workflow from &ldquo;anonymous&rdquo; user</li>
</ul></li>
<li>Allow reviewers to read and delete deposits but not create or update them.</li>
<li>Allow reviewers to assign objects to editorial, published and embargoed queues</li>
<li>Currators have full access to all objects in all queues</li>
</ol>

<p>Jane is a curator. Millie is a reviewer. Anne is a user who we want
to be able to &ldquo;deposit&rdquo; objects but she has no other responsibilities.</p>

<p>Here&rsquo;s the steps to implement a solution</p>

<ol>
<li>Remove &ldquo;anonymous&rdquo; membership in &ldquo;depost&rdquo;</li>
<li>Add user objects for Mille and Anne</li>
<li>Create a workflow called &ldquo;depositor&rdquo; with can create objects in the &ldquo;review&rdquo; queue</li>
<li>Create a workflow called &ldquo;reviewer&rdquo; that operates on the &ldquo;review&rdquo; queue and given that workflow read, delete permission for objects in the queue and is allowed to assign objects to editorial, published and embargoed queues</li>
<li>Create three more workflows to trigger the generation of our remaining</li>
</ol>

<p>Step 1. our &ldquo;anonymous&rdquo; user now should look like</p>

<pre><code class="language-json">    {
        &quot;user_id&quot;: &quot;anonymous&quot;,
        &quot;display_name&quot;: &quot;&quot;,
        &quot;member_of&quot;: [ &quot;public&quot; ]
    }
</code></pre>

<p>Let&rsquo;s create user objects for Millie and Anne.</p>

<pre><code class="language-json">    {
        &quot;user_id&quot;: &quot;millie&quot;,
        &quot;display_name&quot;: &quot;Millie&quot;,
        &quot;member_of&quot;: [ &quot;reviewer&quot; ]
    }
</code></pre>

<pre><code class="language-json">    {
        &quot;user_id&quot;: &quot;anne&quot;,
        &quot;display_name&quot;: &quot;Anne&quot;,
        &quot;member_of&quot;: [ &quot;depositor&quot; ]
    }
</code></pre>

<p>Our depositor workflow looks like</p>

<pre><code class="language-json">    {
        &quot;workflow_id&quot;: &quot;depositor&quot;,
        &quot;workflow_Name&quot;: &quot;Depositor&quot;,
        &quot;queue&quot;: &quot;review&quot;,
        &quot;create&quot;: true,
        &quot;read&quot;: false,
        &quot;update&quot;: false,
        &quot;delete&quot;: false,
        &quot;asign_to&quot;: [ ]
    }
</code></pre>

<p>And our reviewer would look like</p>

<pre><code class="language-json">    {
        &quot;workflow_name&quot;: &quot;Reviewer&quot;,
        &quot;workflow_id&quot;: &quot;reviewer&quot;,
        &quot;queue&quot;: &quot;review&quot;,
        &quot;create&quot;: false,
        &quot;read&quot;: true,
        &quot;update&quot;: false,
        &quot;delete&quot;: true,
        &quot;assign_to&quot;: [ &quot;review&quot;, &quot;editorial&quot;, &quot;published&quot;, &quot;embargoed&quot; ]
    }
</code></pre>

<p>If later we decide Millie should be able to create objects then
we can add her the deposit workflow queue. She would have the
cummulative rights of both the &ldquo;deposit&rdquo; and &ldquo;reviewer&rdquo; workflows.</p>

</section>

<footer>
<span><h1><A href="https://caltech.edu">Caltech</a></h1></span>
<span>&copy; 2019 <a href="https://www.library.caltech.edu/copyright">Caltech library</a></span>
<address>1200 E California Blvd, Mail Code 1-32, Pasadena, CA 91125-3200</address> 
<span>Phone: <a href="tel:+1-626-395-3405">(626)395-3405</a></span>
<span><a href="mailto:library@caltech.edu">Email Us</a></span>
<a class="cl-hide" href="sitemap.xml">Site Map</a>
</footer>
<!-- START: PrettyFi from https://github.com/google/code-prettify -->
<script>
/* We want to add the class "prettyprint" to all the pre elements */
var pre_list = document.querySelectorAll("pre");

pre_list.forEach(function(elem) {
    elem.classList.add("prettyprint");
    elem.classList.add("linenums");/**/
    elem.classList.add("json"); /**/
});
</script>
<style>
li.L0, li.L1, li.L2, li.L3, li.L4, li.L5, li.L6, li.L7, li.L8, li.L9
{
    color: #555;
    list-style-type: decimal;
}
</style>
<link rel="stylesheet" type="text/css" href="/css/prettify.css">
<script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
<!--  END: PrettyFi from https://github.com/google/code-prettify -->
</body>
</html>
